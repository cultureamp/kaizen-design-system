import{b as be,a as lr}from"./defineProperty-C21ZqnLH.js";import{r as m,R as mr}from"./index-CTjT7uj6.js";import{_ as br}from"./inheritsLoose-p_S3dtD8.js";import{a as hr}from"./tslib.es6-CY32MZYl.js";function $(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function pr(e,r){var n=m.useState(function(){return{value:e,callback:r,facade:{get current(){return n.value},set current(t){var u=n.value;u!==t&&(n.value=t,n.callback(t,u))}}}})[0];return n.callback=r,n.facade}var gr=typeof window<"u"?m.useLayoutEffect:m.useEffect,he=new WeakMap;function yr(e,r){var n=pr(null,function(t){return e.forEach(function(u){return $(u,t)})});return gr(function(){var t=he.get(n);if(t){var u=new Set(t),a=new Set(e),o=n.current;u.forEach(function(i){a.has(i)||$(i,null)}),a.forEach(function(i){u.has(i)||$(i,o)})}he.set(n,e)},[e]),n}function Oe(e){return e}function Ie(e,r){r===void 0&&(r=Oe);var n=[],t=!1,u={read:function(){if(t)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=r(a,t);return n.push(o),function(){n=n.filter(function(i){return i!==o})}},assignSyncMedium:function(a){for(t=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(i){return a(i)},filter:function(){return n}}},assignMedium:function(a){t=!0;var o=[];if(n.length){var i=n;n=[],i.forEach(a),o=n}var b=function(){var s=o;o=[],s.forEach(a)},c=function(){return Promise.resolve().then(b)};c(),n={push:function(s){o.push(s),c()},filter:function(s){return o=o.filter(s),n}}}};return u}function X(e,r){return r===void 0&&(r=Oe),Ie(e,r)}function Fr(e){e===void 0&&(e={});var r=Ie(null);return r.options=hr({async:!0,ssr:!1},e),r}var K="data-focus-lock",we="data-focus-lock-disabled",Er="data-no-focus-lock",xr="data-autofocus-inside",Or="data-no-autofocus",V={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Se=X({},function(e){var r=e.target,n=e.currentTarget;return{target:r,currentTarget:n}}),Ae=X(),Ir=X(),wr=Fr({async:!0,ssr:typeof document<"u"}),Sr=m.createContext(void 0),Ar=[],Tr=m.forwardRef(function(r,n){var t,u=m.useState(),a=u[0],o=u[1],i=m.useRef(),b=m.useRef(!1),c=m.useRef(null),s=m.useState({}),f=s[1],v=r.children,h=r.disabled,d=h===void 0?!1:h,l=r.noFocusGuards,p=l===void 0?!1:l,y=r.persistentFocus,g=y===void 0?!1:y,E=r.crossFrame,L=E===void 0?!0:E,C=r.autoFocus,je=C===void 0?!0:C;r.allowTextSelection;var Qe=r.group,Ke=r.className,Ye=r.whiteList,ze=r.hasPositiveIndices,fe=r.shards,B=fe===void 0?Ar:fe,se=r.as,Je=se===void 0?"div":se,de=r.lockProps,Xe=de===void 0?{}:de,Ze=r.sideCar,ve=r.returnFocus,W=ve===void 0?!1:ve,er=r.focusOptions,G=r.onActivation,H=r.onDeactivation,rr=m.useState({}),nr=rr[0],tr=m.useCallback(function(x){var S=x.captureFocusRestore;if(!c.current){var A,O=(A=document)==null?void 0:A.activeElement;c.current=O,O!==document.body&&(c.current=S(O))}i.current&&G&&G(i.current),b.current=!0,f()},[G]),ur=m.useCallback(function(){b.current=!1,H&&H(i.current),f()},[H]),ar=m.useCallback(function(x){var S=c.current;if(S){var A=(typeof S=="function"?S():S)||document.body,O=typeof W=="function"?W(A):W;if(O){var me=typeof O=="object"?O:void 0;c.current=null,x?Promise.resolve().then(function(){return A.focus(me)}):A.focus(me)}}},[W]),or=m.useCallback(function(x){b.current&&Se.useMedium(x)},[]),ir=Ae.useMedium,cr=m.useCallback(function(x){i.current!==x&&(i.current=x,o(x))},[]),fr=be((t={},t[we]=d&&"disabled",t[K]=Qe,t),Xe),le=p!==!0,sr=le&&p!=="tail",dr=yr([n,cr]),vr=m.useMemo(function(){return{observed:i,shards:B,enabled:!d,active:b.current}},[d,b.current,B,a]);return m.createElement(m.Fragment,null,le&&[m.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:d?-1:0,style:V}),ze?m.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:d?-1:1,style:V}):null],!d&&m.createElement(Ze,{id:nr,sideCar:wr,observed:a,disabled:d,persistentFocus:g,crossFrame:L,autoFocus:je,whiteList:Ye,shards:B,onActivation:tr,onDeactivation:ur,returnFocus:ar,focusOptions:er}),m.createElement(Je,be({ref:dr},fr,{className:Ke,onBlur:ir,onFocus:or}),m.createElement(Sr.Provider,{value:vr},v)),sr&&m.createElement("div",{"data-focus-guard":!0,tabIndex:d?-1:0,style:V}))});Tr.propTypes={};function Z(e){setTimeout(e,1)}var Mr=function(r){return r&&"current"in r?r.current:r};function Pr(e,r){function n(t){return t.displayName||t.name||"Component"}return function(u){var a=[],o;function i(){o=e(a.map(function(c){return c.props})),r(o)}var b=function(c){br(s,c);function s(){return c.apply(this,arguments)||this}s.peek=function(){return o};var f=s.prototype;return f.componentDidMount=function(){a.push(this),i()},f.componentDidUpdate=function(){i()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),i()},f.render=function(){return mr.createElement(u,this.props)},s}(m.PureComponent);return lr(b,"displayName","SideEffect("+n(u)+")"),b}}var F=function(e){for(var r=Array(e.length),n=0;n<e.length;++n)r[n]=e[n];return r},w=function(e){return Array.isArray(e)?e:[e]},Te=function(e){return Array.isArray(e)?e[0]:e},kr=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var r=window.getComputedStyle(e,null);return!r||!r.getPropertyValue?!1:r.getPropertyValue("display")==="none"||r.getPropertyValue("visibility")==="hidden"},Me=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},Pe=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},Cr=function(e){return e.hasAttribute("inert")},Nr=function(e,r){return!e||Pe(e)||!kr(e)&&!Cr(e)&&r(Me(e))},ke=function(e,r){var n=e.get(r);if(n!==void 0)return n;var t=Nr(r,ke.bind(void 0,e));return e.set(r,t),t},Dr=function(e,r){return e&&!Pe(e)?Wr(e)?r(Me(e)):!1:!0},Ce=function(e,r){var n=e.get(r);if(n!==void 0)return n;var t=Dr(r,Ce.bind(void 0,e));return e.set(r,t),t},Ne=function(e){return e.dataset},Rr=function(e){return e.tagName==="BUTTON"},De=function(e){return e.tagName==="INPUT"},Re=function(e){return De(e)&&e.type==="radio"},Lr=function(e){return!((De(e)||Rr(e))&&(e.type==="hidden"||e.disabled))},Wr=function(e){var r=e.getAttribute(Or);return![!0,"true",""].includes(r)},ee=function(e){var r;return!!(e&&(!((r=Ne(e))===null||r===void 0)&&r.focusGuard))},Y=function(e){return!ee(e)},_r=function(e){return!!e},Ur=function(e,r){var n=Math.max(0,e.tabIndex),t=Math.max(0,r.tabIndex),u=n-t,a=e.index-r.index;if(u){if(!n)return 1;if(!t)return-1}return u||a},Br=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},re=function(e,r,n){return F(e).map(function(t,u){var a=Br(t);return{node:t,index:u,tabIndex:n&&a===-1?(t.dataset||{}).focusGuard?0:-1:a}}).filter(function(t){return!r||t.tabIndex>=0}).sort(Ur)},Gr=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],ne=Gr.join(","),Hr="".concat(ne,", [data-focus-guard]"),Le=function(e,r){return F((e.shadowRoot||e).children).reduce(function(n,t){return n.concat(t.matches(r?Hr:ne)?[t]:[],Le(t))},[])},$r=function(e,r){var n;return e instanceof HTMLIFrameElement&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?k([e.contentDocument.body],r):[e]},k=function(e,r){return e.reduce(function(n,t){var u,a=Le(t,r),o=(u=[]).concat.apply(u,a.map(function(i){return $r(i,r)}));return n.concat(o,t.parentNode?F(t.parentNode.querySelectorAll(ne)).filter(function(i){return i===t}):[])},[])},Vr=function(e){var r=e.querySelectorAll("[".concat(xr,"]"));return F(r).map(function(n){return k([n])}).reduce(function(n,t){return n.concat(t)},[])},te=function(e,r){return F(e).filter(function(n){return ke(r,n)}).filter(function(n){return Lr(n)})},pe=function(e,r){return r===void 0&&(r=new Map),F(e).filter(function(n){return Ce(r,n)})},ue=function(e,r,n){return re(te(k(e,n),r),!0,n)},_=function(e,r){return re(te(k(e),r),!1)},qr=function(e,r){return te(Vr(e),r)},I=function(e,r){return e.shadowRoot?I(e.shadowRoot,r):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,r)?!0:F(e.children).some(function(n){var t;if(n instanceof HTMLIFrameElement){var u=(t=n.contentDocument)===null||t===void 0?void 0:t.body;return u?I(u,r):!1}return I(n,r)})},jr=function(e){for(var r=new Set,n=e.length,t=0;t<n;t+=1)for(var u=t+1;u<n;u+=1){var a=e[t].compareDocumentPosition(e[u]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&r.add(u),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&r.add(t)}return e.filter(function(o,i){return!r.has(i)})},We=function(e){return e.parentNode?We(e.parentNode):e},ae=function(e){var r=w(e);return r.filter(Boolean).reduce(function(n,t){var u=t.getAttribute(K);return n.push.apply(n,u?jr(F(We(t).querySelectorAll("[".concat(K,'="').concat(u,'"]:not([').concat(we,'="disabled"])')))):[t]),n},[])},Qr=function(e){try{return e()}catch{return}},D=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var r=e.activeElement;return r.shadowRoot?D(r.shadowRoot):r instanceof HTMLIFrameElement&&Qr(function(){return r.contentWindow.document})?D(r.contentWindow.document):r}},Kr=function(e,r){return e===r},Yr=function(e,r){return!!F(e.querySelectorAll("iframe")).some(function(n){return Kr(n,r)})},_e=function(e,r){return r===void 0&&(r=D(Te(e).ownerDocument)),!r||r.dataset&&r.dataset.focusGuard?!1:ae(e).some(function(n){return I(n,r)||Yr(n,r)})},zr=function(e){e===void 0&&(e=document);var r=D(e);return r?F(e.querySelectorAll("[".concat(Er,"]"))).some(function(n){return I(n,r)}):!1},Jr=function(e,r){return r.filter(Re).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},oe=function(e,r){return Re(e)&&e.name?Jr(e,r):e},Xr=function(e){var r=new Set;return e.forEach(function(n){return r.add(oe(n,e))}),e.filter(function(n){return r.has(n)})},ge=function(e){return e[0]&&e.length>1?oe(e[0],e):e[0]},ye=function(e,r){return e.indexOf(oe(r,e))},z="NEW_FOCUS",Zr=function(e,r,n,t,u){var a=e.length,o=e[0],i=e[a-1],b=ee(t);if(!(t&&e.indexOf(t)>=0)){var c=t!==void 0?n.indexOf(t):-1,s=u?n.indexOf(u):c,f=u?e.indexOf(u):-1;if(c===-1)return f!==-1?f:z;if(f===-1)return z;var v=c-s,h=n.indexOf(o),d=n.indexOf(i),l=Xr(n),p=t!==void 0?l.indexOf(t):-1,y=p-(u?l.indexOf(u):c);if(!v&&f>=0||r.length===0)return f;var g=ye(e,r[0]),E=ye(e,r[r.length-1]);if(c<=h&&b&&Math.abs(v)>1)return E;if(c>=d&&b&&Math.abs(v)>1)return g;if(v&&Math.abs(y)>1)return f;if(c<=h)return E;if(c>d)return g;if(v)return Math.abs(v)>1?f:(a+f+v)%a}},en=function(e){return function(r){var n,t=(n=Ne(r))===null||n===void 0?void 0:n.autofocus;return r.autofocus||t!==void 0&&t!=="false"||e.indexOf(r)>=0}},Fe=function(e,r,n){var t=e.map(function(a){var o=a.node;return o}),u=pe(t.filter(en(n)));return u&&u.length?ge(u):ge(pe(r))},J=function(e,r){return r===void 0&&(r=[]),r.push(e),e.parentNode&&J(e.parentNode.host||e.parentNode,r),r},q=function(e,r){for(var n=J(e),t=J(r),u=0;u<n.length;u+=1){var a=n[u];if(t.indexOf(a)>=0)return a}return!1},Ue=function(e,r,n){var t=w(e),u=w(r),a=t[0],o=!1;return u.filter(Boolean).forEach(function(i){o=q(o||i,i)||o,n.filter(Boolean).forEach(function(b){var c=q(a,b);c&&(!o||I(c,o)?o=c:o=q(c,o))})}),o},Ee=function(e,r){return e.reduce(function(n,t){return n.concat(qr(t,r))},[])},rn=function(e,r){var n=new Map;return r.forEach(function(t){return n.set(t.node,t)}),e.map(function(t){return n.get(t)}).filter(_r)},nn=function(e,r){var n=D(w(e).length>0?document:Te(e).ownerDocument),t=ae(e).filter(Y),u=Ue(n||e,e,t),a=new Map,o=_(t,a),i=o.filter(function(d){var l=d.node;return Y(l)});if(i[0]){var b=_([u],a).map(function(d){var l=d.node;return l}),c=rn(b,i),s=c.map(function(d){var l=d.node;return l}),f=c.filter(function(d){var l=d.tabIndex;return l>=0}).map(function(d){var l=d.node;return l}),v=Zr(s,f,b,n,r);if(v===z){var h=Fe(o,f,Ee(t,a))||Fe(o,s,Ee(t,a));if(h)return{node:h};console.warn("focus-lock: cannot find any node to move focus into");return}return v===void 0?v:c[v]}},tn=function(e){var r=ae(e).filter(Y),n=Ue(e,e,r),t=re(k([n],!0),!0,!0),u=k(r,!1);return t.map(function(a){var o=a.node,i=a.index;return{node:o,index:i,lockItem:u.indexOf(o)>=0,guard:ee(o)}})},ie=function(e,r){e&&("focus"in e&&e.focus(r),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},j=0,Q=!1,Be=function(e,r,n){n===void 0&&(n={});var t=nn(e,r);if(!Q&&t){if(j>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Q=!0,setTimeout(function(){Q=!1},1);return}j++,ie(t.node,n.focusOptions),j--}};function N(e){if(!e)return null;if(typeof WeakRef>"u")return function(){return e||null};var r=e?new WeakRef(e):null;return function(){return(r==null?void 0:r.deref())||null}}var un=function(e){if(!e)return null;for(var r=[],n=e;n&&n!==document.body;)r.push({current:N(n),parent:N(n.parentElement),left:N(n.previousElementSibling),right:N(n.nextElementSibling)}),n=n.parentElement;return{element:N(e),stack:r,ownerDocument:e.ownerDocument}},an=function(e){var r,n,t,u,a;if(e)for(var o=e.stack,i=e.ownerDocument,b=new Map,c=0,s=o;c<s.length;c++){var f=s[c],v=(r=f.parent)===null||r===void 0?void 0:r.call(f);if(v&&i.contains(v)){for(var h=(n=f.left)===null||n===void 0?void 0:n.call(f),d=f.current(),l=v.contains(d)?d:void 0,p=(t=f.right)===null||t===void 0?void 0:t.call(f),y=ue([v],b),g=(a=(u=l??(h==null?void 0:h.nextElementSibling))!==null&&u!==void 0?u:p)!==null&&a!==void 0?a:h;g;){for(var E=0,L=y;E<L.length;E++){var C=L[E];if(g!=null&&g.contains(C.node))return C.node}g=g.nextElementSibling}if(y.length)return y[0].node}}},on=function(e){var r=un(e);return function(){return an(r)}},cn=function(e,r,n){if(!e||!r)return console.error("no element or scope given"),{};var t=w(r);if(t.every(function(o){return!I(o,e)}))return console.error("Active element is not contained in the scope"),{};var u=n?ue(t,new Map):_(t,new Map),a=u.findIndex(function(o){var i=o.node;return i===e});if(a!==-1)return{prev:u[a-1],next:u[a+1],first:u[0],last:u[u.length-1]}},fn=function(e,r){var n=r?ue(w(e),new Map):_(w(e),new Map);return{first:n[0],last:n[n.length-1]}},sn=function(e){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},e)},Ge=function(e,r,n){r===void 0&&(r={});var t=sn(r),u=cn(e,t.scope,t.onlyTabbable);if(u){var a=n(u,t.cycle);a&&ie(a.node,t.focusOptions)}},dn=function(e,r){r===void 0&&(r={}),Ge(e,r,function(n,t){var u=n.next,a=n.first;return u||t&&a})},vn=function(e,r){r===void 0&&(r={}),Ge(e,r,function(n,t){var u=n.prev,a=n.last;return u||t&&a})},He=function(e,r,n){var t,u=fn(e,(t=r.onlyTabbable)!==null&&t!==void 0?t:!0),a=u[n];a&&ie(a.node,r.focusOptions)},ln=function(e,r){r===void 0&&(r={}),He(e,r,"first")},mn=function(e,r){r===void 0&&(r={}),He(e,r,"last")},bn=function(){return document&&document.activeElement===document.body},hn=function(){return bn()||zr()},M=null,T=null,P=null,R=!1,pn=function(){return!0},gn=function(r){return(M.whiteList||pn)(r)},yn=function(r,n){P={observerNode:r,portaledElement:n}},Fn=function(r){return P&&P.portaledElement===r};function xe(e,r,n,t){var u=null,a=e;do{var o=t[a];if(o.guard)o.node.dataset.focusAutoGuard&&(u=o);else if(o.lockItem){if(a!==e)return;u=null}else break}while((a+=n)!==r);u&&(u.node.tabIndex=0)}var En=function(r){return r?!!R:R==="meanwhile"},xn=function e(r,n,t){return n&&(n.host===r&&(!n.activeElement||t.contains(n.activeElement))||n.parentNode&&e(r,n.parentNode,t))},On=function(r,n){return n.some(function(t){return xn(r,t,t)})},U=function(){var r=!1;if(M){var n=M,t=n.observed,u=n.persistentFocus,a=n.autoFocus,o=n.shards,i=n.crossFrame,b=n.focusOptions,c=t||P&&P.portaledElement,s=document&&document.activeElement;if(c){var f=[c].concat(o.map(Mr).filter(Boolean));if((!s||gn(s))&&(u||En(i)||!hn()||!T&&a)&&(c&&!(_e(f)||s&&On(s,f)||Fn(s))&&(document&&!T&&s&&!a?(s.blur&&s.blur(),document.body.focus()):(r=Be(f,T,{focusOptions:b}),P={})),R=!1,T=document&&document.activeElement),document&&s!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var v=document&&document.activeElement,h=tn(f),d=h.map(function(l){var p=l.node;return p}).indexOf(v);d>-1&&(h.filter(function(l){var p=l.guard,y=l.node;return p&&y.dataset.focusAutoGuard}).forEach(function(l){var p=l.node;return p.removeAttribute("tabIndex")}),xe(d,h.length,1,h),xe(d,-1,-1,h))}}}return r},$e=function(r){U()&&r&&(r.stopPropagation(),r.preventDefault())},ce=function(){return Z(U)},In=function(r){var n=r.target,t=r.currentTarget;t.contains(n)||yn(t,n)},wn=function(){return null},Ve=function(){R="just",Z(function(){R="meanwhile"})},Sn=function(){document.addEventListener("focusin",$e),document.addEventListener("focusout",ce),window.addEventListener("blur",Ve)},An=function(){document.removeEventListener("focusin",$e),document.removeEventListener("focusout",ce),window.removeEventListener("blur",Ve)};function Tn(e){return e.filter(function(r){var n=r.disabled;return!n})}var qe={moveFocusInside:Be,focusInside:_e,focusNextElement:dn,focusPrevElement:vn,focusFirstElement:ln,focusLastElement:mn,captureFocusRestore:on};function Mn(e){var r=e.slice(-1)[0];r&&!M&&Sn();var n=M,t=n&&r&&r.id===n.id;M=r,n&&!t&&(n.onDeactivation(),e.filter(function(u){var a=u.id;return a===n.id}).length||n.returnFocus(!r)),r?(T=null,(!t||n.observed!==r.observed)&&r.onActivation(qe),U(),Z(U)):(An(),T=null)}Se.assignSyncMedium(In);Ae.assignMedium(ce);Ir.assignMedium(function(e){return e(qe)});const Dn=Pr(Tn,Mn)(wn);export{Tr as F,Dn as a,Fr as c,wr as m,yr as u};
