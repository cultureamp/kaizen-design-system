import { Canvas, Meta, Controls, ArgTypes, DocsStory } from "@storybook/blocks"
import { ResourceLinks, KAIOInstallation } from "~storybook/components"
import { LinkTo } from "../../../../../../../docs/components/LinkTo"
import * as exampleStories from "./LinkButton.doc.stories"

<Meta title="Actions/LinkButton/LinkButton (v3)/API Specification" />

# Button API Specification (v3)

Updated Nov 21, 2024

<ResourceLinks
  sourceCode="https://github.com/cultureamp/kaizen-design-system/tree/main/packages/components/src/__actions__/LinkButton/v3"
  figma="https://www.figma.com/design/eZKEE5kXbEMY3lx84oz8iN/%F0%9F%92%9C-Heart-UI-Kit?node-id=1929-17364"
  designGuidelines="/?path=/docs/actions-linkbutton-linkbutton-v3-usage-guidelines--docs"
/>

<KAIOInstallation exportNames={["LinkButton" ]} family="actions" version="3" />

## Overview

`LinkButton` allows users to navigate to another page or resource within a web page or application.

The following example and table showcases the essential props that enable the core functionality of `LinkButton`. For the remaining suite of API options refer to [this section](#additional-api-options).

<Canvas of={exampleStories.Playground} />

<Controls of={exampleStories.Playground} include={["className", "children", "href", "target", "download", "onPress", "routerOptions", "hasHiddenLabel",  "size", "variant", "icon", "iconPosition", "isFullWidth", "isDisabled" ]} />

## API

This is built on top of [React Aria's Link component](https://react-spectrum.adobe.com/react-aria/Link.html) and is the counterpart to the <LinkTo pageId="actions-button-button-v3-api-specification--docs">Kaizen Button</LinkTo>, handling icons, variants and sizes in the same way. It provides a semantic wrapper for navigational buttons and allows for native `href` navigation and client side routing with [additional configuration](#client-side-routing).

### Native navigation and functionality

{/* // TODO: basic docs on href usage */}

Out of the box, the `LinkButton` offer majority of the native anchor tag's behavior and functionality. `href` will trigger new page loads, `download` will download the reference document in `href`, and `target` can be used to open new tabs and windows.

<Canvas of={exampleStories.DownloadIconButton} />

While additional config can be created to support client side routing, this may impact how it interprets `href` passed to the component - TODO: [more here].(#client-side-routing).


### New tabs and accessibility consideration

The general recommendation is to limit the number of links that open a new tab or window on a single page. While there are valid scenarios that can help avoid loss of data and or progress, as with links in forms, opening a new tab can be disorienting for users, especially for those who have difficulty perceiving visual content.

In order to provide advance warning to all users, it is recommended that any link that uses `target="_blank"` be accompanied by a visual indicator and audible warning, as in the example below.

<Canvas of={exampleStories.LinkButtonOpensInNewTab} />

You can find more context on this recommendation via the [W3C page on the G200 success criteria](https://www.w3.org/TR/WCAG20-TECHS/G200.html).


### Client side routing

While the `LinkButton` supports native `href` navigation out of the box, it is agnostic to the routing technology chosen. Additional set up is required to support client side routing from `React Router` or `Next.js`.

In order to achieve this, you can use the [RouterProvider](https://react-spectrum.adobe.com/react-aria/routing.html#routerprovider) from the `react-aria-components` library, along with the additional configuration for each routing solution.

#### Next.js config example

The following example demonstrates how to use the `RouterProvider` with `Next.js`'s Pages router. This will allow the `LinkButton` to navigate using the `router.push` method.

```tsx
import type {AppProps} from "next/app"
import {type NextRouter, useRouter} from "next/router"
import { RouterProvider } from "react-aria-components"

// This provides the necessary typings for the routerOptions to uses of LinkButton across the app
declare module "react-aria-components" {
  interface RouterConfig {
    routerOptions: NonNullable<Parameters<NextRouter["push"]>[2]>;
  }
}

export default function NextPageRouterApp({ Component, pageProps }: AppProps) {
  const router = useRouter()

  return (
    <RouterProvider
      navigate={(href, opts) => router.push(href, undefined, opts)}
    >
      {/* ...application code */}
    </RouterProvider>
  )
}
```

Additional notes on Next.js config can be found in the React Aria's documentation on the [RouterProvider](https://react-spectrum.adobe.com/react-aria/routing.html#routerprovider), including the alternative setup for the [App router](https://react-spectrum.adobe.com/react-aria/routing.html##app-router).

#### React Router config example
The following example demonstrates how to use the `RouterProvider` with `React Router`'s. This will allow the `LinkButton` to navigate using the `useNavigate` hook.

```tsx
import { RouterProvider } from "react-aria-components"
import { BrowserRouter, NavigateOptions, useHref, useNavigate } from "react-router-dom"

declare module "react-aria-components" {
  interface RouterConfig {
    routerOptions: NavigateOptions
  }
}

function ReactRouterApp() {
  const navigate = useNavigate()

  return (
    <RouterProvider navigate={navigate} useHref={useHref}>
      {/* ...application code */}
      <Routes>
        <Route path="/" element={<HomePage />} />
        {/* ...routes */}
      </Routes>
    </RouterProvider>
  )
}
```

Additional notes can be found in the React Aria's documentation on the using the `RouterProvider` with [React Router](https://react-spectrum.adobe.com/react-aria/routing.html#react-router).

### Variants

`LinkButton` supports the following variants: `primary`, `secondary` and `tertiary`. If the `variant` prop is not specified, the default will be `primary`.

<Canvas of={exampleStories.LinkButtonVariants} />

Reversed variants are handled via the `ReversedColors` Provider.

<DocsStory of={exampleStories.LinkButtonVariantsReversed} expanded={false} />

To enable the reversed theme, you will need to wrap the component or application in the `ReversedColors` provider, ie:

```tsx
import { RouterProvider } from "react-aria-components"
import { Button } from "@kaizen/components/v3/actions"
import { ReversedColors } from "@kaizen/components/v3/utilities"
// application code

return (
  <ReversedColors isReversed={true}>
    <LinkButton {...LinkbuttonProps} />
  </ReversedColors>
)
```

### Sizes

LinkButton supports the following sizes: `small`, `medium` and `large`. If the `size` prop is not specified, the default will be `medium`.

<Canvas of={exampleStories.LinkButtonSizes} />

### `onPress`

As with <LinkTo pageId="actions-button-button-v3-usage-guidelines--docs">Button</LinkTo>, `LinkButton`'s API uses React Aria's `onPress` instead of `onClick`. Functionally this does not change the way we pass click events to a `LinkButton`. Consumers can safely replace `onClick` with `onPress` without any additional changes, ie:

```tsx
<Button
  label="Download doc"
  href="https://cultureamp.com/a-pdf-doc.pdf"
  download
  onClick={e => trackDownloadEvent(e)}
/>
```

Can be replaced with the following:

```tsx
<LinkButton
  href="https://cultureamp.com/a-pdf-doc.pdf"
  download
  onClick={e => trackDownloadEvent(e)}
>
  Download doc
</LinkButton>
```

You can read more about the development and reason behind this pattern [here](https://react-spectrum.adobe.com/blog/building-a-button-part-1.html#touch-interactions).

### LinkButton content and children

Labels and any `LinkButton` content can be passed to the component via `children`. For icons as content, refer to the [next section](#icons-and-positioning).

```tsx
<LinkButton variant="secondary" href="#link">
  Label
</LinkButton>
```

While in most cases, `children` will be a `ReactNode`, `LinkButton` also accepts a render function with React Aria's `LinkRenderProps`. This allows for more advanced styling and rendering options by hooking into React Aria's internal Link state. You can read more about this [here](https://react-spectrum.adobe.com/react-aria/Link.html#styling).

### Icons and positioning

The `icon` property abstracts the need to handle positioning and sizing logic for icons within the `LinkButton`. When paired with the [Icon component](/docs/illustrations-icon-icon-future-api-specification--docs), this will scale the icon to the `LinkButton`'s `size` prop.

<Canvas of={exampleStories.LinkButtonWithIconStart} />

Set the position of the icon using the `iconPosition` prop. This will ensure content is flipped in `RTL` layouts. Note that icons will need the [shouldMirrorInRTL](/docs/illustrations-icon-icon-future-api-specification--docs#mirror-in-rtl) prop set to `true` when mirroring is required.

<Canvas of={exampleStories.LinkButtonWithIconEnd} />


### Icon-only `LinkButton` and `hasHiddenLabel`

To achieve an icon-only `LinkButton` (previously: `IconButton`) use the `icon` prop and set `hasHiddenLabel` to `true`. This will visually hide the button's `children`, while still announcing the content to screen readers.

<Canvas of={exampleStories.IconLinkButton} />

This pattern ensures that the `LinkButton`'s accessible name is determined by its children, which helps to announce relevant content to the screen readers. You can learn more about this [accessible pattern here](https://cultureamp.atlassian.net/wiki/spaces/PA/pages/3833331831/Accessible+button+and+link+labels).


### Full width LinkButtons

If a `LinkButton` is statically the full width of a container you can use the `isFullWidth` property.

<Canvas of={exampleStories.LinkButtonFullWidth} />

For resizing on smaller screens, consider using the `className` prop to leverage CSS media or container queries, ie: `<LinkButton className="w-full md:w-[initial]">Label</LinkButton>`.

## Additional API options

The following table is a collection of additional React Aria and native HTML props that are exposed from the [React Aria Link API](https://react-spectrum.adobe.com/react-aria/Link.html). These are not required for the implementation of `LinkButton` but can be used to extend its functionality. Refer back to the [overview section](#overview) for the core props that enable most use cases.

<ArgTypes of={exampleStories.Playground} exclude={["className", "children", "href", "target", "download", "routerOptions", "hasHiddenLabel",  "size", "variant", "onPress", "icon", "iconPosition", "isFullWidth", "isDisabled" ]}/>
