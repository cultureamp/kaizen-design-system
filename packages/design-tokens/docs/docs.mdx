import { zenTheme, heartTheme } from '../src/themes'
import { Card } from '@kaizen/draft-card'
import { Box } from "@kaizen/component-library";
import { makeCSSVariableTheme } from '../src/utils'
import { ThemesCodeBlocks, SassVariablesCodeBlocks, CodeBlock } from "./DocsComponents"
import appTsx from '!!raw-loader!./examples/App.tsx'
import indexTsx from '!!raw-loader!./examples/index.tsx'
import exampleSass from '!!raw-loader!./examples/example.scss'

# How to use design tokens

Welcome! This document should serve as an explanation for how to use our design tokens - `@kaizen/design-tokens` - and the necessary abstractions that come with them.

## What are Kaizen design tokens?
Kaizen's design tokens are a hierarchical set of variables that partly define what our design system *is*. They contain definitions of design system constants related (but not limited) to color, typography, spacing and layout,
but don't define exactly what components should look like, otherwise they would be containing or re-inventing HTML and CSS. 
They are the set of variables that accompany Kaizen components to make them look and feel as consistent as possible, and are available to be consumed in your own compositions.


As of V3, design tokens are also **themable**; they are intended to be used as if they can be **switched at runtime**. Because of this, we employ [CSS Variables](https://www.w3schools.com/css/css3_variables.asp)
to support this feature, so when consuming tokens in SASS/LESS you should assume they will contain values such as `var(--kz-var-color-...)`, rather than concrete values such as `1.5rem` or `#fff`.


## Getting started

### Theme Manager

The first thing you need to do, per application, is instantiate a *singleton* `ThemeManager` class with the default theme as the initial theme, or another of your choice.
It is responsible for maintaining the state of the currently active theme, and applying themes to the DOM through CSS variables to make them accessible in SASS/LESS/CSS.

<CodeBlock language="typescript" code={
`import { ThemeManager, defaultTheme } from '@kaizen/design-tokens'
export const themeManager = new ThemeManager(defaultTheme);`
} />

Before this code has been executed, no CSS variables will have been defined on the DOM automatically. 
This means that any parts of your UI that are loaded before the theme manager (for example HAML blocks) will render initially without CSS variables defined, which can be bad if no fallbacks are defined in your usages of CSS variables.

The framework accommodates for this in two ways:

- Every SASS variable that contains a CSS variable will provide a fallback value to the default theme. See [SASS Variables](#sass-variables).
- Allows you to import a theme-specific CSS file that defines variables on `:root`, which resides in `@kaizen/design-tokens/css/`. At the time of writing there are 3 files: `zen-theme.css`, `heart-theme.css` and `default-theme.css`, where the default theme is Zen and those two theme files will be identical.
    - For example, you could add a tag to your index.html file such as `<link rel="stylesheet" href="./node_modules/@kaizen/design-tokens/css/heart-theme.css">`
    - You could use CSS imports in a top level CSS file, like: `@import "~@kaizen/design-tokens/css/zen-theme.css"`
    - Or, if your build system supports it, add a JS import statement like `import "@kaizen/design-tokens/css/default-theme.css"`. However, if you are able to load CSS in this manner before all UI components, you can probably instantiate a ThemeManager too. 

The caveat with the alternative methods is that if you need to load a different theme based on user-preferences or feature flags, you will most likely need to use a ThemeManager to control which one is active, hence if the theme loaded initially doesn't match the one loaded by the ThemeManager, incorrect styles may initially flash.

### Using tokens in React

The recommended approach to using design tokens in React is to wrap the application within a `ThemeProvider`, which takes a `ThemeManager`, subscribes to it's current theme, and defines a React context so that you may access the current theme within your components, using the `useTheme` hook.

Example:

<CodeBlock language="typescript" code={indexTsx} caption="index.tsx" />
<CodeBlock language="typescript" code={appTsx} caption="App.tsx" />



### Using tokens in SASS

See [SASS Variables](#sass-variables) for all available tokens.

Example:

<CodeBlock language="scss" code={exampleSass} />

//TODO, more complex examples


#### Transparency and opacity

//TODO: How to use rgb-params and migrate from add-alpha



#### Migrating from compile time SASS functions like add-tint, darken, or mix

//TODO



## Switching Themes

//TODO: How to switch themes using ThemeManager.



## From V2 -> V3
There are two significant and breaking changes that are occurring as of the next release:

- All token variables `$kz-*` are being renamed to `$kz-var-*`, and the latter contain CSS variables.
    - This will allow us to support both sets of SASS variables concurrently while consumers migrate to the new.
- Tokens now contain CSS variables and should be defined on `:root`. 
    - This means that previous usages of compile-time SASS functions will break, for example: `add-tint($kz-color-stone, 90%)`.
    - It also means that if you aren't using the SASS variables the package provides which contain fallback values, you should keep in mind how your application is defining CSS variables, and provide fallbacks as a safety net.



## API

### Themes

The following code blocks depict the structure of Kaizen's Theme type, and some of the variables that are available for you.

<ThemesCodeBlocks />

### SASS Variables

The following code blocks contain the source files for each SASS variable in design tokens.

<SassVariablesCodeBlocks />


### JSON Variables

//TODO: Maybe we don't need this


### ThemeManager

//TODO
