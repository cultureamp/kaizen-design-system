import { Meta } from "@storybook/blocks"
import { InlineNotification } from "~components/Notification"
import CssGeneration from "./assets/css-generation.png"
import InlineFold from "./assets/inline-fold.gif"
import TailwindPlay from "./assets/tailwind-play.gif"

<Meta title="Introduction/Tailwind Preset" />

# Tailwind Preset

This page describes the steps needed to use our [Kaizen Tailwind preset](https://github.com/cultureamp/kaizen-design-system/tree/main/packages/tailwind), not Tailwind itself.
To learn more about Tailwind and how to install it in your project, check out there docs [here](https://tailwindcss.com/docs/installation).

Note: Projects created from [frontend-template](https://github.com/cultureamp/frontend-template) should have steps 1 - 3 completed out of the box.
If your project was created from this template, you should only need to do [Step 4: Useful tools](#4-useful-tools).

- [1. Install the preset](#1-install-the-preset)
- [2. Implement the preset](#2-implement-the-preset)
- [3. Add the Tailwind directives](#3-add-the-tailwind-directives)
- [4. Useful tools](#4-useful-tools)

<br/>

## 1. Install the preset

```bash
yarn add -D @kaizen/tailwind
```

## 2. Implement the Preset

In your tailwind config file, import the preset and add it to your `presets` array.
This will override the default Tailwind preset, and make ours available for use.

```js
// tailwind.config.js

const { Preset } = require("@kaizen/tailwind")

module.exports = {
  // Glob pattern to match files containing TW classes. May be different for your project.
  content: ["./**/*.{ts,tsx}"],
  // Override the default Tailwind preset with the Kaizen one.
  presets: [Preset],
  // This should be a selector that wraps your app. It ensures that your Tailwind classes supersede component styles, by increasing their specificity with the chosen selector.
  important: "#root",
  // Preflight is a heavy-handed css reset. We recommend disabling it in your project.
  corePlugins: {
    preflight: false,
  },
}
```

For preset configuration options, see our [configuration docs](/story/systems-tailwind-configuration--page)

## 3. Add the Tailwind Directives

The following directives need to be included in your project's main css file.

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

These directives inject classes that are needed for certain Tailwind features.
For more information, see [here](https://tailwindcss.com/docs/functions-and-directives).

## 4. Useful tools

### Tailwind Play

Tailwind Play is an online code sandbox with Tailwind set up out of the box. The Kaizen Team has created an instance with the Kaizen Preset values [here](https://play.tailwindcss.com/OUogvUgXQR)

Use this playground to get familiar with our preset, test out new config extensions, create a quick proof of concept, or share code examples with other engineers. Feel free to hit ‚ÄòShare‚Äô - it‚Äôll create a new url without overriding the one provided here.

<img src={TailwindPlay} alt="Tailwind Play" />

The playground also has a great ‚ÄúGenerated CSS‚Äù feature that let‚Äôs you see which css classes are generated by your preset when you implement tailwind utilities. It‚Äôs a great way to see what Tailwind is doing under the hood.

<div className="flex justify-center">
  <img src={CssGeneration} alt="CSS Generation" />
</div>

### Tailwind CSS VSCode IntelliSense plugin

Basic config for the [VSCode plugin](https://marketplace.visualstudio.com/items?itemName=bradlc.vscode-tailwindcss) for Tailwind IntelliSense lives in your project's `settings.json`.

You can customise which keywords trigger IntelliSense using basic strings, or even regex expressions.
Here are some examples you may wish to include in your own project:

```
"tailwindCSS.classAttributes": [
  "class",
  "className",
  "ngClass",
  "classNameOverride"
],
"tailwindCSS.experimental.classRegex": [
  "classnames\\(([^)]*)\\)",
  "classNames\\(([^)]*)\\)",
  "clsx\\(([^)]*)\\)",
  "csx\\(([^)]*)\\)"
]
```

`tailwindCSS.experimental.classRegex` is used to provide intelliSense within your `classnames` functions in your codebase.
Ideally you only add the pattern that is used in your repo.

Calling out that this is still an experimental feature for the VSCode plugin.

### Inline fold VSCode extension
Using tailwind often results in long class names, that can even span over multiple lines.
Inline fold is a great extension that hides/ shows long class strings.

Check it out [here](https://marketplace.visualstudio.com/items?itemName=moalamri.inline-fold):


<div className="flex justify-center">
  <img src={InlineFold} alt="Inline fold VSCode extension" />
</div>

### Prettier plugin

Tailwind now has prettier support! üéâ This [prettier plugin](https://github.com/tailwindlabs/prettier-plugin-tailwindcss) will order your classnames for you.
We'd highly recommend it for the sake of consistency. The Tailwind docs even have a guide [here](https://tailwindcss.com/blog/automatic-class-sorting-with-prettier).

## Configuration

This page provides guidance on potential configuration options and how they work with the preset and Kaizen components.

- [Extending the Kaizen preset](#extending-the-kaizen-preset)
- [Customising the important selector](#customising-the-important-selector)

<br/>

### Extending the Kaizen preset

> Extending your config is a good option when you intend to _reuse_ the style.
> If you need a value not available in our preset for a specific use case, consider using [arbitrary values](https://tailwindcss.com/docs/adding-custom-styles#using-arbitrary-values) instead.

To extend upon the preset with values specific to your project, we recommend passing a theme object to `theme.extend`.

```js
const { Preset } = require("@kaizen/tailwind")

module.exports = {
  presets: [Preset],
  theme: {
    extend: {
      colors: {
        myCoolNewColor: "#ffffff",
        "purple-100": "lime"
      }
    }
  }
}
```

Here, the Kaizen preset overwrites the default Tailwind preset, and the `extend` field adds in some new values.
Be careful though! While adding in a _new_ field to `colors` won't overwrite any existing ones, passing in an existing field _will_. In this example, `purple-100` has unfortunately been overwritten.

`<p className="text-sky">...` ‚ùå Default TW config overwritten by `Preset`

`<p className="text-myCoolNewColor">` ‚úÖ New color added

`<p className="text-purple-100">` Ô∏è‚ùóÔ∏è Value from `Preset` overwritten to "Lime"

`<p className="text-purple-200">` ‚úÖ Value from `Preset` not overwritten

<br/>

### Customising the important selector

If the `"#root"` id selector is incompatible with your application wrapper or you are working with a mono-repo that needs to target a selector with lower specificity, you can change the `important` [configuration option](https://tailwindcss.com/docs/configuration#important-modifier) in your `tailwind.config.js`.

If this is changed or you are not using the [Frontend Template](https://github.com/cultureamp/frontend-template), be sure that the `important` selector matches to an `id`, `class`, or `HTML Element` within your application, ie:

``` tsx
<div id="#root">
 {/* Application code */}
</div>
```

<InlineNotification
  persistent
  type="cautionary"
  style="inline"
  title="Changing the selector"
>
  We advise using an <code>id</code> with <code>&quot;#root&quot;</code> as the default selector. Using different id&apos;s, classes or HTML elements like <code>body</code> as the selector could result in:
  <ul>
    <li>
      Utility classes not superseding Kaizen defaults when using <code>classNameOverride</code>
    </li>
    <li>
      Duplication of utillity classes in your CSS bundle caused by consuming components with different <code>important</code> selectors
    </li>
  </ul>
</InlineNotification>
